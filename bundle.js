(()=>{"use strict";var e={705:e=>{e.exports=function(e){var n=[];return n.toString=function(){return this.map((function(n){var t="",o=void 0!==n[5];return n[4]&&(t+="@supports (".concat(n[4],") {")),n[2]&&(t+="@media ".concat(n[2]," {")),o&&(t+="@layer".concat(n[5].length>0?" ".concat(n[5]):""," {")),t+=e(n),o&&(t+="}"),n[2]&&(t+="}"),n[4]&&(t+="}"),t})).join("")},n.i=function(e,t,o,r,i){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(o)for(var l=0;l<this.length;l++){var a=this[l][0];null!=a&&(s[a]=!0)}for(var c=0;c<e.length;c++){var d=[].concat(e[c]);o&&s[d[0]]||(void 0!==i&&(void 0===d[5]||(d[1]="@layer".concat(d[5].length>0?" ".concat(d[5]):""," {").concat(d[1],"}")),d[5]=i),t&&(d[2]?(d[1]="@media ".concat(d[2]," {").concat(d[1],"}"),d[2]=t):d[2]=t),r&&(d[4]?(d[1]="@supports (".concat(d[4],") {").concat(d[1],"}"),d[4]=r):d[4]="".concat(r)),n.push(d))}},n}},738:e=>{e.exports=function(e){return e[1]}},740:(e,n,t)=>{t.d(n,{Z:()=>l});var o=t(738),r=t.n(o),i=t(705),s=t.n(i)()(r());s.push([e.id,'\nmain {\n    box-sizing: border-box;\n    width: fit-content;\n    margin: 0 auto;\n    margin-top: 30px;\n    padding: 10px;\n    color: rgb(219,138,138);\n    font-family: system-ui, -apple-system, BlinkMacSystemFont, \'Segoe UI\', Roboto, Oxygen, Ubuntu, Cantarell, \'Open Sans\', \'Helvetica Neue\', sans-serif;\n}\n\n.game {\n    display: flex;\n    flex-direction: column;\n    width: fit-content;\n    height: fit-content;\n}\n\n.game__header {\n    margin: 10px;\n}\n\n.header {\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: space-between;\n}\n\n.header__title {\n    font-size: 4.5em;\n    font-weight: bold;\n}\n\n.score {\n    display: flex;\n    flex-direction: column;\n    align-items: flex-end;\n    font-size: 1.5em;\n    font-weight: 600;\n}\n\n.game-main {\n    margin-top: 10px;\n    position: relative;\n}\n\n.grid {\n    display: flex;\n    flex-direction: column;\n    width: fit-content;\n}\n\n.squares-container {\n    position: absolute;\n    z-index: 1;\n}\n\n.cell__square {\n    position: absolute;\n    z-index: 3;\n}\n\n.row {\n    display: flex;\n    flex-direction: row;\n}\n\n.cell {\n    height: 120px;\n    width: 120px;\n    border: 5px solid;\n    border-radius: 6px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background-color: rgb(244, 194, 194);\n    margin-right: -10px;\n    margin-bottom: -10px;\n    box-sizing: border-box;\n}\n\n.cell__inner {\n    height: 100px;\n    width: 100px;\n    margin: 0;\n    padding: 0;\n    border: 5px solid #FBECF0;\n    border-radius: 6px;\n    background-color: #FBECF0;\n    box-sizing: border-box;\n}\n\n.grid, .row, .cell {\n    border-color: rgb(244,194,194);\n}\n\n.square__label {\n    height: 100px;\n    width: 100px;\n    background-color: #E6A4B4;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-weight: bold;\n    font-size: 2rem;\n    border-radius: 6px;\n}\n\n@keyframes appear {\n    0% {\n        opacity: 0;\n        scale: 0;\n    }\n\n    50% {\n        opacity: 0;\n        scale: 0;\n    }\n\n    100% {\n        opacity: 1;\n        scale: 1;\n    }\n}\n\n.square__label--new {\n    animation-duration: 0.6s;\n    animation-name: appear;\n    animation-fill-mode: forwards;\n}\n\n@keyframes merge {\n    0% {\n        opacity: 1;\n        scale: 1;\n    }\n\n    50% {\n        opacity: 1;\n        scale: 1;\n    }\n\n    100% {\n        opacity: 0;\n        scale: 0;\n    }\n}\n\n.square__label--merged {\n    z-index: 2;\n    animation-duration: 0.6s;\n    animation-name: merge;\n    animation-fill-mode: forwards;\n}\n\n.score__value {\n    display: flex;\n    flex-direction: column;\n    margin-bottom: -0.8em;\n}\n\n@keyframes showValueDiff {\n    0% {\n        opacity: 1;\n        bottom: 2em;\n    }\n\n    100% {\n        opacity: 0;\n        bottom: 3em;\n    }\n}\n\n.score-value__value {\n    align-self: flex-end;\n}\n\n.score-value__diff--showing {\n    display: block !important;\n    z-index: 2;\n    animation-duration: 1s;\n    animation-name: showValueDiff;\n    animation-fill-mode: forwards;\n}\n\n.score-value__diff {\n    opacity: 0;\n    position: relative;\n    font-size: 0.8em;\n    left: 100%;\n    bottom: 2em;\n}\n\n[data-value="0"] {\n    background-color: #FBECF0;\n}\n\n[data-value="2"] {\n    background-color: #FFF8E3;\n}\n\n[data-value="4"] {\n    background-color: #F6D9D6;\n}\n\n[data-value="8"] {\n    background-color: #F9F3CC;\n}\n\n[data-value="16"] {\n    background-color: #D7E5CA;\n}\n\n[data-value="32"] {\n    background-color: #C3DDD7;\n}\n\n[data-value="64"] {\n    background-color: #EAF4FA; \n}\n\n[data-value="128"] {\n    background-color: #CEE3EF;\n}\n\n[data-value="256"] {\n    background-color: #F4C3D0;\n}\n\n[data-value="512"] {\n    background-color: #CBC6D9;\n}\n\n[data-value="1024"] {\n    background-color: #AAD7D9;\n}\n\n[data-value="2048"] {\n    background-color: #E0D7FF;\n}\n',""]);const l=s},379:e=>{var n=[];function t(e){for(var t=-1,o=0;o<n.length;o++)if(n[o].identifier===e){t=o;break}return t}function o(e,o){for(var i={},s=[],l=0;l<e.length;l++){var a=e[l],c=o.base?a[0]+o.base:a[0],d=i[c]||0,u="".concat(c," ").concat(d);i[c]=d+1;var h=t(u),m={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==h)n[h].references++,n[h].updater(m);else{var g=r(m,o);o.byIndex=l,n.splice(l,0,{identifier:u,updater:g,references:1})}s.push(u)}return s}function r(e,n){var t=n.domAPI(n);return t.update(e),function(n){if(n){if(n.css===e.css&&n.media===e.media&&n.sourceMap===e.sourceMap&&n.supports===e.supports&&n.layer===e.layer)return;t.update(e=n)}else t.remove()}}e.exports=function(e,r){var i=o(e=e||[],r=r||{});return function(e){e=e||[];for(var s=0;s<i.length;s++){var l=t(i[s]);n[l].references--}for(var a=o(e,r),c=0;c<i.length;c++){var d=t(i[c]);0===n[d].references&&(n[d].updater(),n.splice(d,1))}i=a}}},569:e=>{var n={};e.exports=function(e,t){var o=function(e){if(void 0===n[e]){var t=document.querySelector(e);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(e){t=null}n[e]=t}return n[e]}(e);if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}},216:e=>{e.exports=function(e){var n=document.createElement("style");return e.setAttributes(n,e.attributes),e.insert(n,e.options),n}},565:(e,n,t)=>{e.exports=function(e){var n=t.nc;n&&e.setAttribute("nonce",n)}},795:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var n=e.insertStyleElement(e);return{update:function(t){!function(e,n,t){var o="";t.supports&&(o+="@supports (".concat(t.supports,") {")),t.media&&(o+="@media ".concat(t.media," {"));var r=void 0!==t.layer;r&&(o+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),o+=t.css,r&&(o+="}"),t.media&&(o+="}"),t.supports&&(o+="}");var i=t.sourceMap;i&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),n.styleTagTransform(o,e,n.options)}(n,e,t)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)}}}},589:e=>{e.exports=function(e,n){if(n.styleSheet)n.styleSheet.cssText=e;else{for(;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(document.createTextNode(e))}}}},n={};function t(o){var r=n[o];if(void 0!==r)return r.exports;var i=n[o]={id:o,exports:{}};return e[o](i,i.exports,t),i.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),t.nc=void 0,(()=>{var e=t(379),n=t.n(e),o=t(795),r=t.n(o),i=t(569),s=t.n(i),l=t(565),a=t.n(l),c=t(216),d=t.n(c),u=t(589),h=t.n(u),m=t(740),g={};g.styleTagTransform=h(),g.setAttributes=a(),g.insert=s().bind(null,"head"),g.domAPI=r(),g.insertStyleElement=d(),n()(m.Z,g),m.Z&&m.Z.locals&&m.Z.locals;class f{#e;#n;#t;#o;#r;#i;constructor({row:e,cell:n,value:t}){this.#e=Math.random().toString(16).slice(2),this.#n=e,this.#t=n,this.#o=t,this.#r=!1,this.#i=!0}editPosition(e,n){console.log("newRow, newCell",e,n),this.#n=e,this.#t=n,this.#i=!1}makeMerged(){this.#r=!0,this.#i=!1}isNotNew(){this.#i=!1}get id(){return this.#e}get row(){return this.#n}get cell(){return this.#t}get value(){return this.#o}get merged(){return this.#r}get new(){return this.#i}}new class{constructor({model:e,view:n}){this.model=e,this.view=n;let[t,o]=this.model.getAnyEmptyPosition();this.view.createSquare(this.model.addSquare(t,o,this.model.minNumber).id,t,o,this.model.minNumber),[t,o]=this.model.getAnyEmptyPosition(),this.view.createSquare(this.model.addSquare(t,o,this.model.minNumber).id,t,o,this.model.minNumber),this.view.bindMoveLeft((()=>{(this.model.changed||"L"!==this.model.lastDirection)&&this.model.sumLeft(),this.model.changed&&(this.model.addSquare(...this.model.getAnyEmptyPosition(),this.model.minNumber),this.applyСhanges())})),this.view.bindMoveRight((()=>{(this.model.changed||"R"!==this.model.lastDirection)&&this.model.sumRight(),this.model.changed&&(this.model.addSquare(...this.model.getAnyEmptyPosition(),this.model.minNumber),this.applyСhanges())})),this.view.bindMoveUp((()=>{(this.model.changed||"U"!==this.model.lastDirection)&&this.model.sumUp(),this.model.changed&&(this.model.addSquare(...this.model.getAnyEmptyPosition(),this.model.minNumber),this.applyСhanges())})),this.view.bindMoveDown((()=>{(this.model.changed||"D"!==this.model.lastDirection)&&this.model.sumDown(),this.model.changed&&(this.model.addSquare(...this.model.getAnyEmptyPosition(),this.model.minNumber),this.applyСhanges())}))}applyСhanges(){this.view.deleteMergedSquares(),this.model.squares.filter((e=>!e.new)).forEach((e=>{this.view.editSquarePosition(e.id,e.row,e.cell,e.merged)})),this.model.squares.filter((e=>e.new&&e.value>this.model.minNumber)).forEach((e=>{this.view.createSquare(e.id,e.row,e.cell,e.value)})),this.model.scoreDiff>0&&this.view.changeScore(this.model.score,this.model.scoreDiff),this.model.squares.filter((e=>e.new&&e.value===this.model.minNumber)).forEach((e=>{this.view.createSquare(e.id,e.row,e.cell,e.value)})),console.log("test",this.model.squares)}}({model:new class{#s;#l;#a;#c;#d;rows;columns;minNumber;constructor({rows:e,columns:n,minNumber:t}){this.rows=e,this.columns=n,this.minNumber=t,this.score=0,this.scoreDiff=0,this.changed=!0,this.lastDirection=null,this.squares=new Array}get changed(){return this.#a}set changed(e){this.#a=e}get lastDirection(){return this.#c}set lastDirection(e){this.#c=e}get squares(){return this.#d}set squares(e){this.#d=e}get score(){return this.#s}set score(e){this.#s=e}get scoreDiff(){return this.#l}set scoreDiff(e){this.#l=e}getAnyEmptyPosition(){let e,n;for([e,n]=[Math.floor(Math.random()*this.rows),Math.floor(Math.random()*this.columns)];this.squares.some((t=>t.row===e&&t.cell===n));)[e,n]=[Math.floor(Math.random()*this.rows),Math.floor(Math.random()*this.columns)];return console.log("NEW EMPTY POSITIONS",e,n),[e,n]}addSquare(e,n,t){const o=new f({row:e,cell:n,value:t});return this.squares.push(o),t>this.minNumber&&(this.score=this.score+t,this.scoreDiff=this.scoreDiff+t),o}deleteMergedSquares(){this.squares=this.squares.filter((e=>!e.merged))}sumLeft(){console.log("--------------------"),this.deleteMergedSquares(),this.changed=!1,this.scoreDiff=0,this.lastDirection="L";for(let e=0;e<this.rows;e++){console.log("row = ",e);let n=null,t=null,o=null;const r=this.squares.filter((n=>n.row===e)).sort(((e,n)=>e.cell-n.cell));for(let i=0;i<r.length;i++)n=r[i],n.isNotNew(),console.log("a before",n.id,n.row,n.cell),0===i&&0!==n.cell&&(n.editPosition(e,0),this.changed=!0),console.log("a after",n.id,n.row,n.cell),i+1<r.length&&(t=r[i+1],console.log("b before",t.id,t.row,t.cell),n.merged||t.merged||n.value!==t.value?t.cell!==n.cell+1&&(t.editPosition(n.row,n.cell+1),this.changed=!0):(t.editPosition(n.row,n.cell),n.makeMerged(),t.makeMerged(),console.log("a.value === b.value",n.id,t.id),o=this.addSquare(n.row,n.cell,n.value+t.value),this.changed=!0),console.log("b after",t.id,t.row,t.cell))}console.log("changed",this.changed),console.log("--------------------")}sumRight(){console.log("--------------------"),this.deleteMergedSquares(),this.changed=!1,this.scoreDiff=0,this.lastDirection="R";for(let e=0;e<this.rows;e++){console.log("row = ",e);let n=null,t=null,o=null;const r=this.squares.filter((n=>n.row===e)).sort(((e,n)=>n.cell-e.cell));for(let i=0;i<r.length;i++)n=r[i],n.isNotNew(),console.log("a before",n.id,n.row,n.cell),0===i&&n.cell!==this.columns-1&&(n.editPosition(e,this.columns-1),this.changed=!0),console.log("a after",n.id,n.row,n.cell),i+1<r.length&&(t=r[i+1],console.log("b before",t.id,t.row,t.cell),n.merged||t.merged||n.value!==t.value?t.cell!==n.cell-1&&(t.editPosition(n.row,n.cell-1),this.changed=!0):(t.editPosition(n.row,n.cell),n.makeMerged(),t.makeMerged(),console.log("a.value === b.value",n.id,t.id),o=this.addSquare(n.row,n.cell,n.value+t.value),this.changed=!0),console.log("b after",t.id,t.row,t.cell))}console.log("--------------------")}sumUp(){console.log("--------------------"),this.deleteMergedSquares(),this.changed=!1,this.scoreDiff=0,this.lastDirection="U";for(let e=0;e<this.columns;e++){console.log("column = ",e);let n=null,t=null,o=null;const r=this.squares.filter((n=>n.cell===e)).sort(((e,n)=>e.row-n.row));for(let i=0;i<r.length;i++)n=r[i],n.isNotNew(),console.log("a before",n.id,n.row,n.cell),0===i&&0!==n.row&&(n.editPosition(0,e),this.changed=!0),console.log("a after",n.id,n.row,n.cell),i+1<r.length&&(t=r[i+1],console.log("b before",t.id,t.row,t.cell),n.merged||t.merged||n.value!==t.value?t.row!==n.row+1&&(t.editPosition(n.row+1,n.cell),this.changed=!0):(t.editPosition(n.row,n.cell),n.makeMerged(),t.makeMerged(),console.log("a.value === b.value",n.id,t.id),o=this.addSquare(n.row,n.cell,n.value+t.value),this.changed=!0),console.log("b after",t.id,t.row,t.cell))}console.log("--------------------")}sumDown(){console.log("--------------------"),this.deleteMergedSquares(),this.changed=!1,this.scoreDiff=0,this.lastDirection="D";for(let e=0;e<this.columns;e++){console.log("column = ",e);let n=null,t=null,o=null;const r=this.squares.filter((n=>n.cell===e)).sort(((e,n)=>n.row-e.row));for(let i=0;i<r.length;i++)n=r[i],n.isNotNew(),console.log("a before",n.id,n.row,n.cell),0===i&&n.row!==this.rows-1&&(n.editPosition(this.rows-1,e),this.changed=!0),console.log("a after",n.id,n.row,n.cell),i+1<r.length&&(t=r[i+1],console.log("b before",t.id,t.row,t.cell),n.merged||t.merged||n.value!==t.value?t.row!==n.row-1&&(t.editPosition(n.row-1,n.cell),this.changed=!0):(t.editPosition(n.row,n.cell),n.makeMerged(),t.makeMerged(),console.log("a.value === b.value",n.id,t.id),o=this.addSquare(n.row,n.cell,n.value+t.value),this.changed=!0),console.log("b after",t.id,t.row,t.cell))}console.log("--------------------")}}({rows:4,columns:4,minNumber:2}),view:new class{constructor({rows:e,columns:n}){this.rows=e,this.columns=n,this.grid=document.querySelector(".grid"),this.squaresContainer=document.querySelector(".squares-container");const t=document.querySelector("style").sheet;for(let o,r,i,s,l=0;l<e;l++){o=document.createElement("div"),o.classList.add("grid__row","row"),this.grid.appendChild(o);for(let e=0;e<n;e++)r=document.createElement("div"),r.classList.add("row__cell","cell"),o.appendChild(r),i=document.createElement("div"),i.classList.add("cell__inner"),r.appendChild(i),s=`[data-row="${l}"][data-cell="${e}"] {\n                    transform: translate(${110*e+10}px, ${110*l-430}px); \n                    transition: transform 0.6s;\n                }`,t.insertRule(s,t.cssRules.length)}}createSquare(e,n,t,o,r){let i,s;i=document.getElementById(e),i||(i=document.createElement("div"),i.id=e,i.classList.add("cell__square","square"),i.dataset.row=n,i.dataset.cell=t,i.dataset.merged=!1,s=document.createElement("div"),s.classList.add("square__label","square__label--new"),s.innerHTML=o,s.dataset.value=o,s.addEventListener("animationend",(function(e){e.target.classList.remove("square__label--new")})),i.appendChild(s),this.squaresContainer.appendChild(i))}editSquarePosition(e,n,t,o){let r;r=document.getElementById(e),console.log("id, row, cell",e,n,t),console.log(r),r&&(r.getAnimations().forEach((e=>e.finish())),r.dataset.row=n,r.dataset.cell=t,o&&(r.dataset.merged=!0,r.children[0].classList.add("square__label--merged")))}mergeSquare(e){console.log("id",e);const n=document.getElementById(e);console.log("square",n),n&&(n.dataset.merged=!0)}deleteMergedSquares(){document.querySelectorAll(".cell__square[data-merged=true]").forEach((e=>e.remove()))}changeScore(e,n){document.querySelector(".score-value__value").innerHTML=e;const t=document.querySelector(".score-value__diff");t.classList.remove("score-value__diff--showing"),t.getAnimations().forEach((e=>e.finish())),t.innerHTML="+"+n,t.classList.add("score-value__diff--showing")}bindMoveLeft(e){document.addEventListener("keydown",(function(n){n.preventDefault(),"ArrowLeft"==n.code&&e()}))}bindMoveRight(e){document.addEventListener("keydown",(function(n){n.preventDefault(),"ArrowRight"==n.code&&e()}))}bindMoveUp(e){document.addEventListener("keydown",(function(n){n.preventDefault(),"ArrowUp"==n.code&&e()}))}bindMoveDown(e){document.addEventListener("keydown",(function(n){n.preventDefault(),"ArrowDown"==n.code&&e()}))}}({rows:4,columns:4})})})()})();